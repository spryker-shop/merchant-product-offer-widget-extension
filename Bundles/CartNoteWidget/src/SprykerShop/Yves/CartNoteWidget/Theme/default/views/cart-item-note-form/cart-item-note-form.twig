{% extends template('widget') %}

{% define data = {
    idQuote: _widget.cart.idQuote,
    form: _widget.cartNoteForm
} %}

{% set canWrite = (not is_granted('ROLE_USER') or can('WriteSharedCartPermissionPlugin', data.idQuote)) %}

{% block body %}
    {% if canWrite %}
        {% include molecule('form') with {
            data: {
                form: data.form,
                options: {
                    action: url('cart-note/item')
                },
                submit: {
                    enable: true,
                    text: 'cart_note.form.save' | trans
                }
            }
        } only %}
    {% elseif data.form.cartNote.vars.value is not empty %}
        <div class="form">
            {{ 'cart_note.checkout_page.item_note' | trans }}: {{ data.form.cartNote.vars.value }}
        </div>
    {% endif %}
{% endblock %}
